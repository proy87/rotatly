{% extends "base.html" %}
{% load static %}
{% block meta_title %}Leaderboard | Rotatly{% endblock %}
{% block css %}
    <link href="{% static "css/leaderboard.css" %}?v=7" rel="stylesheet">
{% endblock %}
{% block content %}
    <section class="leaderboard-screen">
        <div class="leaderboard-container">
            <!-- Header Row: Back + Title + Date Picker -->
            <header class="leaderboard-header">
                <div class="leaderboard-header-left">
                    <a href="{% url 'daily' %}" class="leaderboard-back-btn">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M7.5 9L4.5 6L7.5 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Back</span>
                    </a>
                    <h1 class="leaderboard-title">Leaderboard</h1>
                </div>

                <div class="leaderboard-date-picker" id="date-picker-container">
                    <input
                        class="leaderboard-date-input"
                        type="text"
                        id="date-picker"
                        placeholder="Select date"
                        autocomplete="off"
                        aria-label="Select puzzle date"
                        readonly
                    >
                    <svg class="leaderboard-date-icon" width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M1.66675 9.99998C1.66675 6.85728 1.66675 5.28593 2.64306 4.30962C3.61937 3.33331 5.19072 3.33331 8.33341 3.33331H11.6667C14.8094 3.33331 16.3808 3.33331 17.3571 4.30962C18.3334 5.28593 18.3334 6.85728 18.3334 9.99998V11.6666C18.3334 14.8093 18.3334 16.3807 17.3571 17.357C16.3808 18.3333 14.8094 18.3333 11.6667 18.3333H8.33341C5.19072 18.3333 3.61937 18.3333 2.64306 17.357C1.66675 16.3807 1.66675 14.8093 1.66675 11.6666V9.99998Z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M5.83325 3.33331V2.08331" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M14.1667 3.33331V2.08331" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M2.08325 7.5H17.9166" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <circle cx="14.1666" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="14.1666" cy="10.8333" r="0.833" fill="currentColor"/>
                        <circle cx="10.0001" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="10.0001" cy="10.8333" r="0.833" fill="currentColor"/>
                        <circle cx="5.83333" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="5.83333" cy="10.8333" r="0.833" fill="currentColor"/>
                    </svg>
                </div>
            </header>

            <!-- Leaderboard Table -->
            <div class="leaderboard-table-wrapper" id="leaderboard-table-wrapper">
                <table class="leaderboard-table" id="leaderboard-table">
                    <thead class="leaderboard-thead">
                        <tr class="leaderboard-header-row">
                            <th class="leaderboard-th leaderboard-th--place" data-sort="place">
                                <span>Place</span>
                                <svg class="leaderboard-sort-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.99997 8.75C8.2008 8.75 8.38215 8.87016 8.46043 9.05511C8.53871 9.24006 8.49873 9.4539 8.35892 9.59807L5.69226 12.3481C5.59808 12.4452 5.46858 12.5 5.33331 12.5C5.19803 12.5 5.06853 12.4452 4.97435 12.3481L2.30769 9.59807C2.16788 9.4539 2.1279 9.24006 2.20618 9.05511C2.28446 8.87016 2.46581 8.75 2.66664 8.75H4.8333V4C4.8333 3.72386 5.05716 3.5 5.3333 3.5C5.60945 3.5 5.8333 3.72386 5.8333 4V8.75H7.99997Z" fill="currentColor"/>
                                    <path d="M13.3333 7.25C13.5341 7.25 13.7155 7.12984 13.7938 6.94489C13.872 6.75994 13.8321 6.5461 13.6923 6.40193L11.0256 3.65193C10.9314 3.55481 10.8019 3.5 10.6666 3.5C10.5314 3.5 10.4019 3.55481 10.3077 3.65193L7.64102 6.40193C7.50121 6.5461 7.46124 6.75994 7.53952 6.94489C7.6178 7.12984 7.79914 7.25 7.99997 7.25H10.1666V12C10.1666 12.2761 10.3905 12.5 10.6666 12.5C10.9428 12.5 11.1666 12.2761 11.1666 12L11.1666 7.25H13.3333Z" fill="currentColor"/>
                                </svg>
                            </th>
                            <th class="leaderboard-th leaderboard-th--player" data-sort="player">
                                <span>Player name</span>
                                <svg class="leaderboard-sort-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.99997 8.75C8.2008 8.75 8.38215 8.87016 8.46043 9.05511C8.53871 9.24006 8.49873 9.4539 8.35892 9.59807L5.69226 12.3481C5.59808 12.4452 5.46858 12.5 5.33331 12.5C5.19803 12.5 5.06853 12.4452 4.97435 12.3481L2.30769 9.59807C2.16788 9.4539 2.1279 9.24006 2.20618 9.05511C2.28446 8.87016 2.46581 8.75 2.66664 8.75H4.8333V4C4.8333 3.72386 5.05716 3.5 5.3333 3.5C5.60945 3.5 5.8333 3.72386 5.8333 4V8.75H7.99997Z" fill="currentColor"/>
                                    <path d="M13.3333 7.25C13.5341 7.25 13.7155 7.12984 13.7938 6.94489C13.872 6.75994 13.8321 6.5461 13.6923 6.40193L11.0256 3.65193C10.9314 3.55481 10.8019 3.5 10.6666 3.5C10.5314 3.5 10.4019 3.55481 10.3077 3.65193L7.64102 6.40193C7.50121 6.5461 7.46124 6.75994 7.53952 6.94489C7.6178 7.12984 7.79914 7.25 7.99997 7.25H10.1666V12C10.1666 12.2761 10.3905 12.5 10.6666 12.5C10.9428 12.5 11.1666 12.2761 11.1666 12L11.1666 7.25H13.3333Z" fill="currentColor"/>
                                </svg>
                            </th>
                            <th class="leaderboard-th leaderboard-th--time" data-sort="time">
                                <span>Time</span>
                                <svg class="leaderboard-sort-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.99997 8.75C8.2008 8.75 8.38215 8.87016 8.46043 9.05511C8.53871 9.24006 8.49873 9.4539 8.35892 9.59807L5.69226 12.3481C5.59808 12.4452 5.46858 12.5 5.33331 12.5C5.19803 12.5 5.06853 12.4452 4.97435 12.3481L2.30769 9.59807C2.16788 9.4539 2.1279 9.24006 2.20618 9.05511C2.28446 8.87016 2.46581 8.75 2.66664 8.75H4.8333V4C4.8333 3.72386 5.05716 3.5 5.3333 3.5C5.60945 3.5 5.8333 3.72386 5.8333 4V8.75H7.99997Z" fill="currentColor"/>
                                    <path d="M13.3333 7.25C13.5341 7.25 13.7155 7.12984 13.7938 6.94489C13.872 6.75994 13.8321 6.5461 13.6923 6.40193L11.0256 3.65193C10.9314 3.55481 10.8019 3.5 10.6666 3.5C10.5314 3.5 10.4019 3.55481 10.3077 3.65193L7.64102 6.40193C7.50121 6.5461 7.46124 6.75994 7.53952 6.94489C7.6178 7.12984 7.79914 7.25 7.99997 7.25H10.1666V12C10.1666 12.2761 10.3905 12.5 10.6666 12.5C10.9428 12.5 11.1666 12.2761 11.1666 12L11.1666 7.25H13.3333Z" fill="currentColor"/>
                                </svg>
                            </th>
                            <th class="leaderboard-th leaderboard-th--moves" data-sort="moves">
                                <span>Moves</span>
                                <svg class="leaderboard-sort-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.99997 8.75C8.2008 8.75 8.38215 8.87016 8.46043 9.05511C8.53871 9.24006 8.49873 9.4539 8.35892 9.59807L5.69226 12.3481C5.59808 12.4452 5.46858 12.5 5.33331 12.5C5.19803 12.5 5.06853 12.4452 4.97435 12.3481L2.30769 9.59807C2.16788 9.4539 2.1279 9.24006 2.20618 9.05511C2.28446 8.87016 2.46581 8.75 2.66664 8.75H4.8333V4C4.8333 3.72386 5.05716 3.5 5.3333 3.5C5.60945 3.5 5.8333 3.72386 5.8333 4V8.75H7.99997Z" fill="currentColor"/>
                                    <path d="M13.3333 7.25C13.5341 7.25 13.7155 7.12984 13.7938 6.94489C13.872 6.75994 13.8321 6.5461 13.6923 6.40193L11.0256 3.65193C10.9314 3.55481 10.8019 3.5 10.6666 3.5C10.5314 3.5 10.4019 3.55481 10.3077 3.65193L7.64102 6.40193C7.50121 6.5461 7.46124 6.75994 7.53952 6.94489C7.6178 7.12984 7.79914 7.25 7.99997 7.25H10.1666V12C10.1666 12.2761 10.3905 12.5 10.6666 12.5C10.9428 12.5 11.1666 12.2761 11.1666 12L11.1666 7.25H13.3333Z" fill="currentColor"/>
                                </svg>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- Rows will be rendered by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Empty State -->
            <div class="leaderboard-empty" id="empty-state">
                <div class="leaderboard-empty-icon">
                    <svg width="36" height="36" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <g clip-path="url(#clip0_empty_trophy)">
                            <path d="M10.0002 13.3333C5.20026 13.3333 4.34994 8.54961 4.19931 4.75538C4.1574 3.69997 4.13645 3.17226 4.53289 2.68402C4.92932 2.19577 5.40379 2.11572 6.35273 1.95561C7.28945 1.79756 8.51392 1.66666 10.0002 1.66666C11.4865 1.66666 12.711 1.79756 13.6477 1.95561C14.5966 2.11572 15.0711 2.19577 15.4675 2.68402C15.864 3.17226 15.843 3.69997 15.8011 4.75538C15.6505 8.54961 14.8002 13.3333 10.0002 13.3333Z" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M15.8333 4.16666L16.6238 4.43016C17.4488 4.70518 17.8613 4.84269 18.0973 5.17006C18.3332 5.49743 18.3332 5.93226 18.3332 6.80194L18.3332 6.86238C18.3332 7.57966 18.3332 7.93831 18.1605 8.23174C17.9879 8.52516 17.6743 8.69934 17.0473 9.04769L14.5833 10.4167" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M4.1667 4.16666L3.37618 4.43016C2.55113 4.70518 2.13861 4.84269 1.90266 5.17006C1.66671 5.49743 1.66673 5.93226 1.66675 6.80194L1.66675 6.86238C1.66677 7.57966 1.66678 7.93831 1.83944 8.23174C2.01209 8.52516 2.32561 8.69934 2.95262 9.04769L5.4167 10.4167" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M10 14.1667V15.8333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M12.9166 18.3333H7.08325L7.36594 16.9199C7.44384 16.5304 7.78585 16.25 8.18309 16.25H11.8167C12.214 16.25 12.556 16.5304 12.6339 16.9199L12.9166 18.3333Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15 18.3333H5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </g>
                        <defs>
                            <clipPath id="clip0_empty_trophy">
                                <rect width="20" height="20" fill="white"/>
                            </clipPath>
                        </defs>
                    </svg>
                </div>
                <p class="leaderboard-empty-text">No entries yet</p>
                <p class="leaderboard-empty-subtext">Be the first to complete this puzzle and claim the top spot!</p>
                <a href="{% url 'daily' %}" class="leaderboard-empty-btn">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M9 3.75V14.25M3.75 9H14.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Play Now
                </a>
            </div>
        </div>
    </section>
{% endblock %}
{% block js %}
    <script>
        const leaderboardConfig = {
            minDateIso: '{{ min_date_js }}',
            maxDateIso: '{{ max_date_js }}',
            currentDateIso: '{{ current_date_js }}',
            currentDateFormatted: '{{ current_date }}',
            currentUserId: {{ user.id|default:'null' }},
            currentUsername: '{{ user.username|default:"" }}',
        };
    </script>
    <script src="{% static 'js/leaderboard.js' %}?v=7"></script>
{% endblock %}
