{% extends "base.html" %}
{% load static %}
{% block meta_title %}Profile | Rotatly{% endblock %}
{% block css %}
    <link href="{% static "css/profile.css" %}?v=41" rel="stylesheet">
{% endblock %}
{% block content %}
    <section class="profile-screen">
        <div class="profile-container">
            <!-- Header -->
            <header class="profile-header">
                <div class="profile-header-left">
                    <a href="{% url 'daily' %}" class="profile-back-btn">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M7.5 9L4.5 6L7.5 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Back</span>
                    </a>
                    <h1 class="profile-title">Profile</h1>
                </div>

                <div class="profile-user">
                    <div class="profile-user-icon-wrap">
                        <svg class="profile-user-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M5 17.5V15.8333C5 14.9493 5.35119 14.1014 5.97631 13.4763C6.60143 12.8512 7.44928 12.5 8.33333 12.5H11.6667C12.5507 12.5 13.3986 12.8512 14.0237 13.4763C14.6488 14.1014 15 14.9493 15 15.8333V17.5M6.66667 5.83333C6.66667 6.71739 7.01786 7.56523 7.64298 8.19036C8.2681 8.81548 9.11594 9.16667 10 9.16667C10.8841 9.16667 11.7319 8.81548 12.357 8.19036C12.9821 7.56523 13.3333 6.71739 13.3333 5.83333C13.3333 4.94928 12.9821 4.10143 12.357 3.47631C11.7319 2.85119 10.8841 2.5 10 2.5C9.11594 2.5 8.2681 2.85119 7.64298 3.47631C7.01786 4.10143 6.66667 4.94928 6.66667 5.83333Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <span class="profile-username"><b>{% if user.is_authenticated %}{{ user.username }}{% else %}Guest{% endif %}</b></span>
                </div>
            </header>

            <!-- Toolbar (Tabs + Search) -->
            <div class="profile-toolbar">
                <!-- Tabs -->
                <div class="profile-tabs" role="tablist">
                    <button
                        class="profile-tab profile-tab--active"
                        type="button"
                        data-tab="daily"
                        role="tab"
                        aria-selected="true"
                    >
                        Daily Puzzle
                    </button>
                    <button
                        class="profile-tab"
                        type="button"
                        data-tab="custom"
                        role="tab"
                        aria-selected="false"
                    >
                        Custom Puzzle
                    </button>
                </div>

                <!-- Search -->
                <div class="profile-search">
                    <input
                        class="profile-search-input"
                        type="text"
                        id="search-date"
                        placeholder="Search by date"
                        autocomplete="off"
                        aria-label="Search puzzles by date"
                    >
                    <svg class="profile-search-icon" width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M1.66675 9.99998C1.66675 6.85728 1.66675 5.28593 2.64306 4.30962C3.61937 3.33331 5.19072 3.33331 8.33341 3.33331H11.6667C14.8094 3.33331 16.3808 3.33331 17.3571 4.30962C18.3334 5.28593 18.3334 6.85728 18.3334 9.99998V11.6666C18.3334 14.8093 18.3334 16.3807 17.3571 17.357C16.3808 18.3333 14.8094 18.3333 11.6667 18.3333H8.33341C5.19072 18.3333 3.61937 18.3333 2.64306 17.357C1.66675 16.3807 1.66675 14.8093 1.66675 11.6666V9.99998Z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M5.83325 3.33331V2.08331" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M14.1667 3.33331V2.08331" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M2.08325 7.5H17.9166" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <circle cx="14.1666" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="14.1666" cy="10.8333" r="0.833" fill="currentColor"/>
                        <circle cx="10.0001" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="10.0001" cy="10.8333" r="0.833" fill="currentColor"/>
                        <circle cx="5.83333" cy="14.1667" r="0.833" fill="currentColor"/>
                        <circle cx="5.83333" cy="10.8333" r="0.833" fill="currentColor"/>
                    </svg>
                </div>
            </div>

            <!-- Puzzle List -->
            <div class="profile-list-wrapper" id="puzzle-list-wrapper" style="display: {% if has_puzzles %}block{% else %}none{% endif %};">
                <div class="profile-list" id="puzzle-list">
                    <!-- Entries will be rendered by JavaScript -->
                </div>
            </div>

            <!-- Empty State -->
            <div class="profile-empty" id="empty-state" style="display: {% if has_puzzles %}none{% else %}flex{% endif %};">
                <div class="profile-empty-icon">
                    <i class="fa-solid fa-puzzle-piece" aria-hidden="true"></i>
                </div>
                <p class="profile-empty-text">No puzzles yet</p>
                <p class="profile-empty-subtext">Complete your first puzzle to see your progress and stats here</p>
                <a href="{% url 'daily' %}" class="profile-empty-btn">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M9 3.75V14.25M3.75 9H14.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Play Now
                </a>
            </div>
        </div>
    </section>
{% endblock %}
{% block js %}
    <script>
        const puzzleData = {{ puzzle_data|safe }};
    </script>
    <script src="{% static 'js/profile.js' %}?v=2"></script>
{% endblock %}
